import { ControlSection } from '../../ControlSection/ControlSection.jsx'

function CareerObjectives({ details, updateDetails }) {
  const listItems = details.careerObjectives
  const bemClassName = 'career-objective'
  const stateName = 'careerObjectives'
  const headingName = 'Career Objectives'
  const updateFn = updateDetails
  const getLabel = (section) => `${section.data.slice(0, 30)}...`

  const inputs = (
    <>
      <textarea
        className={`dialog--${bemClassName}__textarea`}
        name={bemClassName}
        rows="5"
        cols="33"
        onChange={(e) => {
          const dialog = document.querySelector(`.dialog--${bemClassName}`)
          const listId = dialog.getAttribute('data-id')
          const updatedData = {
            [stateName]: listItems.map((data) => {
              if (listId !== data.id.toString()) return data
              return Object.assign({}, data, { data: e.target.value })
            }),
          }
          updateFn(updatedData)
        }}
      />
    </>
  )

  return (
    <ControlSection
      {...{
        listItems,
        bemClassName,
        stateName,
        headingName,
        updateFn,
        inputs,
        getLabel,
      }}
    />
  )
}
function CoreQualifications({ details, updateDetails }) {
  const listItems = details.coreQualifications
  const bemClassName = 'core-qualifications'
  const stateName = 'coreQualifications'
  const headingName = 'Core Qualifications'
  const updateFn = updateDetails
  const getLabel = (section) => section.data.slice()
  const inputs = (
    <>
      <input
        type="text"
        onChange={(e) => {
          const dialog = document.querySelector(`.dialog--${bemClassName}`)
          const id = dialog.getAttribute('data-id')
          const updatedData = listItems.map((data) =>
            data.id.toString() !== id
              ? data
              : Object.assign({}, data, { data: e.target.value })
          )

          updateFn({ [stateName]: updatedData })
        }}
      />
    </>
  )

  return (
    <ControlSection
      {...{
        listItems,
        bemClassName,
        stateName,
        headingName,
        updateFn,
        inputs,
        getLabel,
      }}
    />
  )
}

function Education({ updateDetails, details }) {
  const listItems = details.education
  const bemClassName = 'education'
  const stateName = 'education'
  const headingName = 'Education'
  const updateFn = updateDetails
  const getLabel = (data) => data.degree
  function checkboxFn(e) {
    const updatedData = listItems.map((ed) => {
      if (ed.id.toString() !== this.id.toString()) return ed
      return Object.assign({}, ed, { isVisible: e.target.checked })
    })

    updateFn({ [stateName]: updatedData })
  }

  return (
    <ControlSection
      {...{
        listItems,
        bemClassName,
        stateName,
        headingName,
        updateFn,
        getLabel,
        //checkboxFn,
      }}
    />
  )
}

export default { CareerObjectives, CoreQualifications, Education }
